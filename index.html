<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script id="bookmarkletscript">
    
        function initBookmarklet()
        {
            window.rateFlixPort = RATEFLIXPORT;
            if (window.getRateFlixMain)
            {
                window.getRateFlixMain();
                return;
            }

            console.log("Initbookmarklet");
            var s = document.createElement("script");
            s.type = "module";
            s.src = "http://localhost:RATEFLIXPORT/maincode.js";

            document.body.appendChild(s);
        }

    </script>
    <script>
        function run()
        {
            console.log("run");
            var elem = document.getElementById("bookmarkletscript");
            var data = elem.innerHTML;

            data = data.replaceAll("RATEFLIXPORT", "" + document.location.port);
            data = "void((function() { " + data + "\ninitBookmarklet(); })())";
            console.log(data);

            elem = document.getElementById("bookmarkletlink");
            elem.setAttribute("href", "javascript:" + encodeURIComponent(data));
        }
    </script>
</head>
<body onload="run()">
    <a href="javascript:void(0)" id="bookmarkletlink">RateFlix</a></p>    
</body>
</html>
